<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Lone Spur Precision | Precision Rifle Manufacturing</title>

  <!-- SEO BASICS -->
  <meta name="description" content="Lone Spur Precision provides precision rifle manufacturing, gunsmithing, and firearms services by appointment in Plano, Texas." />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg-dark: #0e0e0e;
      --bg-light: #f6f6f6;
      --accent: #9c7c3a;
      --text-dark: #111;
      --text-light: #f2f2f2;
      --max-width: 1100px;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
      line-height: 1.6;
      color: var(--text-dark);
      background: var(--bg-light);
    }

    /* ---------- HERO ---------- */
    .hero {
      background: linear-gradient(rgba(0,0,0,.75), rgba(0,0,0,.75)),
        url("https://images.unsplash.com/photo-1603988363607-e1e4a66962c2?auto=format&fit=crop&w=1600&q=80");
      background-size: cover;
      background-position: center;
      color: var(--text-light);
    }

    .hero-inner {
      max-width: var(--max-width);
      margin: 0 auto;
      padding: 96px 24px;
    }

    .logo {
      font-size: 0.9rem;
      letter-spacing: 2px;
      color: var(--accent);
      margin-bottom: 16px;
      text-transform: uppercase;
    }

    .hero h1 {
      font-size: clamp(2.2rem, 5vw, 3.2rem);
      margin: 0 0 12px;
      letter-spacing: 1px;
    }

    .hero p {
      font-size: 1.15rem;
      max-width: 700px;
      color: #ddd;
    }

    /* ---------- SECTIONS ---------- */
    .section {
      max-width: var(--max-width);
      margin: 0 auto;
      padding: 72px 24px;
    }

    .section h2 {
      font-size: 1.9rem;
      margin-bottom: 16px;
    }

    .section h2::after {
      content: "";
      display: block;
      width: 60px;
      height: 3px;
      background: var(--accent);
      margin-top: 8px;
    }

    /* ---------- SERVICES ---------- */
    .services {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 24px;
      margin-top: 32px;
    }

    .service-card {
      background: #fff;
      padding: 28px;
      border-radius: 6px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.06);
      border-left: 4px solid var(--accent);
    }

    /* ---------- GALLERY ---------- */
    .gallery {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 16px;
      margin-top: 32px;
    }

    .gallery img {
      width: 100%;
      height: 220px;
      object-fit: cover;
      border-radius: 4px;
    }

    /* ---------- FORM ---------- */
    form {
      max-width: 500px;
      margin-top: 24px;
    }

    label {
      display: block;
      margin-top: 16px;
      font-weight: 600;
    }

    input, textarea, select {
      width: 100%;
      padding: 10px;
      margin-top: 6px;
      border-radius: 4px;
      border: 1px solid #ccc;
      font-family: inherit;
      font-size: 1rem;
      background: #fff;
    }

    button {
      margin-top: 20px;
      padding: 12px 24px;
      background: var(--accent);
      border: none;
      color: #fff;
      font-size: 1rem;
      cursor: pointer;
      border-radius: 4px;
    }

    button:disabled {
      opacity: 0.75;
      cursor: not-allowed;
    }

    #formStatus {
      margin-top: 12px;
      min-height: 1.25em; /* prevents layout jump */
    }

    /* ---------- POPUP MODAL ---------- */
    .modal { position: fixed; inset: 0; display: none; z-index: 9999; }
    .modal.is-open { display: block; }

    .modal__backdrop {
      position: absolute; inset: 0;
      background: rgba(0,0,0,.55);
    }

    .modal__panel {
      position: relative;
      max-width: 520px;
      margin: 10vh auto;
      background: #fff;
      border-radius: 14px;
      padding: 22px 20px;
      box-shadow: 0 20px 60px rgba(0,0,0,.25);
      outline: none;
    }

    .modal__title { margin: 0 0 8px; font-size: 1.25rem; }
    .modal__body { margin: 0 0 16px; line-height: 1.45; }

    .modal__actions { display: flex; justify-content: flex-end; gap: 10px; }
    .modal__btn {
      border: 0;
      border-radius: 10px;
      padding: 10px 14px;
      cursor: pointer;
      background: #111;
      color: #fff;
      font-size: 1rem;
    }

    .modal__close {
      position: absolute;
      top: 10px; right: 12px;
      border: 0;
      background: transparent;
      font-size: 24px;
      cursor: pointer;
      line-height: 1;
    }

    /* ---------- DISCLAIMER ---------- */
    .disclaimer {
      background: #eee;
      font-size: 0.9rem;
      color: #444;
      padding: 48px 24px;
    }

    footer {
      text-align: center;
      padding: 24px;
      font-size: 0.85rem;
      color: #777;
      background: #000;
    }
  </style>
</head>

<body>

  <!-- HERO -->
  <section class="hero">
    <div class="hero-inner">
      <div class="logo">Lone Spur Precision</div>
      <h1>Precision Firearms Manufacturing</h1>
      <p>
        Custom rifle builds, firearms manufacturing, and professional gunsmithing.
        By appointment only.
      </p>
    </div>
  </section>

  <!-- ABOUT -->
  <section class="section">
    <h2>About</h2>
    <p>
      Serving Plano, Texas and surrounding areas. Lone Spur Precision focuses on
      precision-driven firearms work with craftsmanship and accuracy
      at every step.
    </p>
  </section>

  <!-- SERVICES -->
  <section class="section">
    <h2>Services</h2>
    <div class="services">
      <div class="service-card">
        <h3>Custom Rifle Builds</h3>
        <p>Purpose-built rifles tailored to your application and performance goals.</p>
      </div>
      <div class="service-card">
        <h3>Firearms Manufacturing</h3>
        <p>Precision made rifle actions and lower receivers.</p>
      </div>
      <div class="service-card">
        <h3>Gunsmithing</h3>
        <p>Repair, service, and optimization of existing firearms.</p>
      </div>
    </div>
  </section>

  <!-- GALLERY -->
  <section class="section">
    <h2>Gallery</h2>
    <div class="gallery">
      <img src="https://images.unsplash.com/photo-1585079542156-2755d9c8a094?auto=format&fit=crop&w=800&q=80" alt="Firearms workbench">
      <img src="https://images.unsplash.com/photo-1613376023733-0a73315d9b06?auto=format&fit=crop&w=800&q=80" alt="Precision machining">
      <img src="https://images.unsplash.com/photo-1601933470928-c54fd49a88b8?auto=format&fit=crop&w=800&q=80" alt="Rifle detail">
    </div>
  </section>

  <!-- CONTACT -->
  <section class="section" id="contact">
    <h2>Contact Us</h2>
    <p>Please submit a request below for sales, info or appointments.</p>
    <p>Please note appointments are required for firearm pickup and drop off.</p>

    <form id="apptForm">
      <label>Request Type
        <select name="request_type" required>
          <option value="" disabled selected>Select one…</option>
          <option value="Sales">Sales Inquiry</option>
          <option value="Information">Information Request</option>
          <option value="Appointment">Appointment Request</option>
        </select>
      </label>

      <label>Name
        <input type="text" name="name" required>
      </label>

      <label>Email
        <input type="email" name="email" required>
      </label>

      <label>Phone (optional)
        <input type="tel" name="phone">
      </label>

      <label>Message
        <textarea name="message" rows="5" required></textarea>
      </label>

      <div class="cf-turnstile" data-sitekey="0x4AAAAAACX1GoTVIhQ0xV5o"></div>

      <input type="text" name="company" style="display:none">

      <button type="submit">Submit Contact Form</button>

      <!-- Inline status used ONLY for errors (success uses popup) -->
      <p id="formStatus" aria-live="polite"></p>
    </form>

    <!-- POPUP MODAL (success only) -->
    <div id="submitModal" class="modal" aria-hidden="true">
      <div class="modal__backdrop" data-close="true"></div>

      <div class="modal__panel" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
        <button type="button" class="modal__close" aria-label="Close" data-close="true">×</button>

        <h3 id="modalTitle" class="modal__title">Message sent</h3>
        <p id="modalBody" class="modal__body">We’ll be in touch shortly.</p>

        <div class="modal__actions">
          <button type="button" class="modal__btn" data-close="true">OK</button>
        </div>
      </div>
    </div>

    <!-- Turnstile script -->
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>

    <!-- Form submit behavior -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const form = document.getElementById("apptForm");
        const status = document.getElementById("formStatus");
        if (!form) return;

        const btn = form.querySelector('button[type="submit"]');

        const modal = document.getElementById("submitModal");
        const panel = modal?.querySelector(".modal__panel");
        const modalTitle = document.getElementById("modalTitle");
        const modalBody = document.getElementById("modalBody");

        // Stay on page: after popup closes, just return to contact section
        const AFTER_CLOSE_SCROLL_TARGET = "#contact";

        let autoCloseTimer = null;

        function openModal(title, body) {
          modalTitle.textContent = title;
          modalBody.textContent = body;

          modal.classList.add("is-open");
          modal.setAttribute("aria-hidden", "false");
          document.body.style.overflow = "hidden";

          // Auto-scroll to popup + focus it (accessibility)
          setTimeout(() => {
            if (panel) {
              panel.scrollIntoView({ behavior: "smooth", block: "center" });
              panel.setAttribute("tabindex", "-1");
              panel.focus({ preventScroll: true });
            }
          }, 0);

          // Auto-close after 7 seconds
          autoCloseTimer = setTimeout(() => closeModal({ scrollAfter: true }), 7000);
        }

        function closeModal({ scrollAfter = true } = {}) {
          modal.classList.remove("is-open");
          modal.setAttribute("aria-hidden", "true");
          document.body.style.overflow = "";

          if (autoCloseTimer) clearTimeout(autoCloseTimer);

          // "Redirect" while staying on page: go to the contact anchor
          if (scrollAfter && AFTER_CLOSE_SCROLL_TARGET) {
            // update the hash (acts like a redirect but stays on the page)
            window.location.hash = AFTER_CLOSE_SCROLL_TARGET;
            // and smooth scroll to it (more consistent across browsers)
            const target = document.querySelector(AFTER_CLOSE_SCROLL_TARGET);
            if (target) target.scrollIntoView({ behavior: "smooth", block: "start" });
          }
        }

        // Close modal on backdrop / X / OK
        modal.addEventListener("click", (e) => {
          if (e.target?.dataset?.close === "true") closeModal({ scrollAfter: true });
        });

        // Close on ESC
        document.addEventListener("keydown", (e) => {
          if (e.key === "Escape" && modal.classList.contains("is-open")) {
            closeModal({ scrollAfter: true });
          }
        });

        function withTimeout(ms) {
          const controller = new AbortController();
          const id = setTimeout(() => controller.abort(), ms);
          return { controller, clear: () => clearTimeout(id) };
        }

        function getSuccessCopy(requestType) {
          if (requestType === "Sales") {
            return {
              title: "Sales inquiry received",
              body: "Thank you — we have received your sales inquiry. We’ll reach out shortly with next steps and availability."
            };
          }
          if (requestType === "Appointment") {
            return {
              title: "Appointment request received",
              body: "Thanks — we have received your appointment request. We’ll follow up to confirm details and scheduling."
            };
          }
          if (requestType === "Information") {
            return {
              title: "Information Request received",
              body: "Thanks — we have received your request. We’ll be in touch soon."
            };
          }
          return {
            title: "Request received",
            body: "Thanks — we got your message. We’ll be in touch soon."
          };
        }

        form.addEventListener("submit", async (e) => {
          e.preventDefault();
          status.textContent = "Sending…";
          btn.disabled = true;

          const t = withTimeout(15000);

          try {
            const formData = new FormData(form);
            const requestType = (formData.get("request_type") || "").toString();

            const res = await fetch("/api/appointment", {
              method: "POST",
              body: formData,
              signal: t.controller.signal
            });

            const text = await res.text();
            let data = {};
            try { data = JSON.parse(text); } catch {}

            // Errors => inline only (no popup)
            if (!res.ok) {
              status.textContent = data.error
                ? `Error (${res.status}): ${data.error}`
                : `Error (${res.status}). Please try again.`;
              return;
            }

            // Success => popup only
            status.textContent = "";

            const copy = getSuccessCopy(requestType);
            openModal(copy.title, copy.body);

            form.reset();

          } catch (err) {
            status.textContent = err.name === "AbortError"
              ? "Timed out. Please try again."
              : "Network error. Please try again.";
          } finally {
            t.clear();
            if (window.turnstile) window.turnstile.reset();
            btn.disabled = false;
          }
        });
      });
    </script>

  </section>

  <!-- DISCLAIMER -->
  <section class="disclaimer">
    <strong>Legal & Compliance Notice:</strong>
    <p>
      All firearms services are performed in compliance with applicable federal,
      state, and local laws. Lone Spur Industries LLC d/b/a Lone Spur Precision does not provide legal advice.
      Customers are responsible for ensuring compliance with all regulations.
    </p>
  </section>

  <footer>
    &copy; 2026 Lone Spur Industries LLC d/b/a Lone Spur Precision. All rights reserved.
  </footer>

</body>
</html>


